
<% # @param lineno 行番号. 1始まり
   # @param detail_obj 詳細行オブジェクト 
   # goods_receipt_pos/_form から呼び出される
  %>

<div id="<%= "detail_#{lineno}" %>" >
  <%= fields_for "detail[#{lineno}]", detail_obj do |df| %>
<% if !detail_obj.errors.empty? %>
  <div style="color:red">
<%   detail_obj.errors.full_messages.each do |msg| %>
    <%= msg %>
<%   end %>
  </div>
<% end %>

  <div class="row border-bottom border-primary"
       data-controller="inv-detail-row">
    <div class="col-3">
<%    if detail_obj.item %>
      <%= df.hidden_field :item_id %>
      <%= detail_obj.item.name %>
<%    else %>
      <%= df.select :item_id, options_from_collection_for_select(Item.all, :id, :name, detail_obj.item_id) %>
<% end %>
    </div>
    <div class="col-2">
<%    if detail_obj.item %>
      <%= MovementDetail.where(order_id: @order.id, item_id: detail_obj.item_id).take.balance %>
<%    end %>
    </div>
    <div class="col-2">
      <%= df.number_field :quantity %>
      <%= df.text_field :uom, value:"uom", disabled:true %>
    </div>
  </div>
<%   end # fields_for %>
</div>
  
